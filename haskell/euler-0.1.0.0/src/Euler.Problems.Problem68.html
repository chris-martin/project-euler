<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |

The string is 16 digits iff the 10 is on an external node.
So we fix the 10 at index 0, an arbitrary external node.

The indices in this diagram are arbitrary, except for 0; since it
represents 10, it must be on the outer ring.

       0
        \
         5     1
        /  \  /
       9    6
      /\   /
     4  8-7--2
         \
          3

-}</span><span>
</span><a name="line-20"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Euler.Problems.Problem68</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Euler.Problems.Problem68.html#answer"><span class="hs-identifier hs-var">answer</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Euler.Prelude.html"><span class="hs-identifier">Euler.Prelude</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Euler.Util.Foldable.html"><span class="hs-identifier">Euler.Util.Foldable</span></a><span> </span><span class="hs-special">(</span><a href="Euler.Util.Foldable.html#allEqual"><span class="hs-identifier hs-var">allEqual</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Foldable</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="Group"><a href="Euler.Problems.Problem68.html#Group"><span class="hs-identifier">Group</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-34"></a><span class="hs-keyword">type</span><span> </span><a name="Ring"><a href="Euler.Problems.Problem68.html#Ring"><span class="hs-identifier">Ring</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Euler.Problems.Problem68.html#Group"><span class="hs-identifier hs-type">Group</span></a><span class="hs-special">]</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-identifier">answer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-37"></a><a name="answer"><a href="Euler.Problems.Problem68.html#answer"><span class="hs-identifier">answer</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-identifier hs-var">Foldable.maximum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Euler.Problems.Problem68.html#magicRings"><span class="hs-identifier hs-var">magicRings</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-identifier">magicRings</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Euler.Problems.Problem68.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span class="hs-special">]</span><span>
</span><a name="line-41"></a><a name="magicRings"><a href="Euler.Problems.Problem68.html#magicRings"><span class="hs-identifier">magicRings</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="Euler.Problems.Problem68.html#isMagic"><span class="hs-identifier hs-var">isMagic</span></a><span> </span><a href="Euler.Problems.Problem68.html#rings"><span class="hs-identifier hs-var">rings</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-identifier">isMagic</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euler.Problems.Problem68.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-45"></a><a name="isMagic"><a href="Euler.Problems.Problem68.html#isMagic"><span class="hs-identifier">isMagic</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>  </span><a href="Euler.Util.Foldable.html#allEqual"><span class="hs-identifier hs-var">allEqual</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Foldable.sum</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">{- |

All rings that produce 16-digit strings, possibly including repetition.

-}</span><span>
</span><a name="line-53"></a><span class="hs-identifier">rings</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Euler.Problems.Problem68.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span class="hs-special">]</span><span>
</span><a name="line-54"></a><a name="rings"><a href="Euler.Problems.Problem68.html#rings"><span class="hs-identifier">rings</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">permutations</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">9</span><span class="hs-special">]</span><span> </span><a href="Euler.Prelude.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679050420"><a href="#local-6989586621679050420"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-56"></a><span>  </span><a href="Euler.Problems.Problem68.html#indices"><span class="hs-identifier hs-var">indices</span></a><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679050420"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><a href="Euler.Problems.Problem68.html#cycleToMin"><span class="hs-identifier hs-var">cycleToMin</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">{- |

Groups from the diagram above. The starting point is arbitrary, but it's
important that the groups are in clockwise order.

-}</span><span>
</span><a name="line-64"></a><span class="hs-identifier">indices</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euler.Problems.Problem68.html#Ring"><span class="hs-identifier hs-type">Ring</span></a><span>
</span><a name="line-65"></a><a name="indices"><a href="Euler.Problems.Problem68.html#indices"><span class="hs-identifier">indices</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">5</span><span class="hs-special">,</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-number">6</span><span class="hs-special">,</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><span class="hs-number">7</span><span class="hs-special">,</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-number">3</span><span class="hs-special">,</span><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-number">4</span><span class="hs-special">,</span><span> </span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">{- |

Rotate the circle around such that the minimum element is first.

-}</span><span>
</span><a name="line-78"></a><span class="hs-identifier">cycleToMin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679050419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050419"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050419"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-79"></a><a name="cycleToMin"><a href="Euler.Problems.Problem68.html#cycleToMin"><span class="hs-identifier">cycleToMin</span></a></a><span> </span><a name="local-6989586621679050421"><a href="#local-6989586621679050421"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679050422"><a href="#local-6989586621679050422"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euler.Problems.Problem68.html#indexOfMin"><span class="hs-identifier hs-var">indexOfMin</span></a><span> </span><a href="#local-6989586621679050421"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-81"></a><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">List.drop</span><span> </span><a href="#local-6989586621679050422"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679050421"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">List.take</span><span> </span><a href="#local-6989586621679050422"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679050421"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">{- |

The index of the minimum element in the list.

-}</span><span>
</span><a name="line-88"></a><span class="hs-identifier">indexOfMin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679050418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679050418"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-89"></a><a name="indexOfMin"><a href="Euler.Problems.Problem68.html#indexOfMin"><span class="hs-identifier">indexOfMin</span></a></a><span> </span><a name="local-6989586621679050423"><a href="#local-6989586621679050423"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier hs-var">List.zip</span><span> </span><a href="#local-6989586621679050423"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">Foldable.minimum</span><span> </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-91"></a></pre></body></html>