<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Module      :  Data.List.Ordered</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Copyright   :  (c) 2009-2011 Leon P Smith</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License     :  BSD3</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Maintainer  :  leon@melding-monads.com</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- This module implements bag and set operations on ordered lists.  For the</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- purposes of this module,  a \&quot;bag\&quot; (or \&quot;multiset\&quot;) is a non-decreasing</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- list, whereas a \&quot;set\&quot; is a strictly ascending list.  Bags are sorted</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- lists that may contain duplicates,  whereas sets are sorted lists that</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- do not contain duplicates.</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Except for the  'nub', 'sort', 'nubSort', and 'isSorted' families of</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- functions, every function assumes that any list arguments are sorted</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- lists. Assuming this precondition is met,  every resulting list is also</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- sorted.</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- Because 'isect' handles multisets correctly, it does not return results</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- comparable to @Data.List.'Data.List.intersect'@ on them.  Thus @isect@</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- is more than just a more efficient @intersect@ on ordered lists. Similar</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- statements apply to other associations between functions this module and</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- functions in @Data.List@,  such as 'union' and @Data.List.'union'@.</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- All functions in this module are left biased.  Elements that appear in</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- earlier arguments have priority over equal elements that appear in later</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- arguments,  and elements that appear earlier in a single list have</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- priority over equal elements that appear later in that list.</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">module</span><span>  </span><span class="hs-identifier">Data.List.Ordered</span><span>
</span><a name="line-38"></a><span>     </span><span class="hs-special">(</span><span>
</span><a name="line-39"></a><span>        </span><span class="hs-comment">-- * Predicates</span><span>
</span><a name="line-40"></a><span>        </span><a href="Data.List.Ordered.html#member"><span class="hs-identifier hs-var">member</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#memberBy"><span class="hs-identifier hs-var">memberBy</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#has"><span class="hs-identifier hs-var">has</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#hasBy"><span class="hs-identifier hs-var">hasBy</span></a><span>
</span><a name="line-41"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#subset"><span class="hs-identifier hs-var">subset</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#subsetBy"><span class="hs-identifier hs-var">subsetBy</span></a><span>
</span><a name="line-42"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#isSorted"><span class="hs-identifier hs-var">isSorted</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#isSortedBy"><span class="hs-identifier hs-var">isSortedBy</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span>        </span><span class="hs-comment">-- * Insertion Functions</span><span>
</span><a name="line-45"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#insertBag"><span class="hs-identifier hs-var">insertBag</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#insertBagBy"><span class="hs-identifier hs-var">insertBagBy</span></a><span>
</span><a name="line-46"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#insertSet"><span class="hs-identifier hs-var">insertSet</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#insertSetBy"><span class="hs-identifier hs-var">insertSetBy</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>        </span><span class="hs-comment">-- * Set-like operations</span><span>
</span><a name="line-49"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#isect"><span class="hs-identifier hs-var">isect</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#isectBy"><span class="hs-identifier hs-var">isectBy</span></a><span>
</span><a name="line-50"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span>
</span><a name="line-51"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#minus"><span class="hs-identifier hs-var">minus</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#minusBy"><span class="hs-identifier hs-var">minusBy</span></a><span>
</span><a name="line-52"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#minus%27"><span class="hs-identifier hs-var">minus'</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#minusBy%27"><span class="hs-identifier hs-var">minusBy'</span></a><span>
</span><a name="line-53"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#xunion"><span class="hs-identifier hs-var">xunion</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#xunionBy"><span class="hs-identifier hs-var">xunionBy</span></a><span>
</span><a name="line-54"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#merge"><span class="hs-identifier hs-var">merge</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span>
</span><a name="line-55"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#mergeAll"><span class="hs-identifier hs-var">mergeAll</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#mergeAllBy"><span class="hs-identifier hs-var">mergeAllBy</span></a><span>
</span><a name="line-56"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#unionAll"><span class="hs-identifier hs-var">unionAll</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#unionAllBy"><span class="hs-identifier hs-var">unionAllBy</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><span class="hs-comment">-- * Lists to Ordered Lists</span><span>
</span><a name="line-59"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#nub"><span class="hs-identifier hs-var">nub</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span>
</span><a name="line-60"></a><span>     </span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">sort</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sortBy</span><span>
</span><a name="line-61"></a><span>     </span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">sortOn</span><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#sortOn%27"><span class="hs-identifier hs-var">sortOn'</span></a><span>
</span><a name="line-62"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#nubSort"><span class="hs-identifier hs-var">nubSort</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#nubSortBy"><span class="hs-identifier hs-var">nubSortBy</span></a><span>
</span><a name="line-63"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#nubSortOn"><span class="hs-identifier hs-var">nubSortOn</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#nubSortOn%27"><span class="hs-identifier hs-var">nubSortOn'</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>        </span><span class="hs-comment">-- * Miscellaneous folds</span><span>
</span><a name="line-66"></a><span>     </span><span class="hs-special">,</span><span>  </span><a href="Data.List.Ordered.html#foldt"><span class="hs-identifier hs-var">foldt</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Ordered.html#foldt%27"><span class="hs-identifier hs-var">foldt'</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>     </span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sort</span><span class="hs-special">,</span><span class="hs-identifier hs-var">sortBy</span><span class="hs-special">,</span><span class="hs-identifier hs-var">intersect</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-cpp">#if  MIN_VERSION_base(4,7,1)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sortOn</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- |  The 'isSorted' predicate returns 'True' if the elements of a list occur</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- in non-descending order,  equivalent to @'isSortedBy' ('&lt;=')@.</span><span>
</span><a name="line-77"></a><span class="hs-identifier">isSorted</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022889"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-78"></a><a name="isSorted"><a href="Data.List.Ordered.html#isSorted"><span class="hs-identifier">isSorted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#isSortedBy"><span class="hs-identifier hs-var">isSortedBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- |  The 'isSortedBy' function returns 'True' iff the predicate returns true</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- for all adjacent pairs of elements in the list.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">isSortedBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022888"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022888"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022888"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-83"></a><a name="isSortedBy"><a href="Data.List.Ordered.html#isSortedBy"><span class="hs-identifier">isSortedBy</span></a></a><span> </span><a name="local-6989586621679022890"><a href="#local-6989586621679022890"><span class="hs-identifier">lte</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022891"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><a name="local-6989586621679022891"><a href="#local-6989586621679022891"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022892"><a href="#local-6989586621679022892"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022893"><a href="#local-6989586621679022893"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022894"><a href="#local-6989586621679022894"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022892"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679022890"><span class="hs-identifier hs-var">lte</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679022893"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679022891"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022893"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022894"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- |  The 'member' function returns 'True' if the element appears in the</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- ordered list.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">member</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022887"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679022887"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022887"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-92"></a><a name="member"><a href="Data.List.Ordered.html#member"><span class="hs-identifier">member</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#memberBy"><span class="hs-identifier hs-var">memberBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- |  The 'memberBy' function is the non-overloaded version of 'member'.</span><span>
</span><a name="line-95"></a><span class="hs-identifier">memberBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022886"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022886"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022886"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022886"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-96"></a><a name="memberBy"><a href="Data.List.Ordered.html#memberBy"><span class="hs-identifier">memberBy</span></a></a><span> </span><a name="local-6989586621679022895"><a href="#local-6989586621679022895"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679022896"><a href="#local-6989586621679022896"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022897"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-98"></a><span>    </span><a name="local-6989586621679022897"><a href="#local-6989586621679022897"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022898"><a href="#local-6989586621679022898"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022899"><a href="#local-6989586621679022899"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022895"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022896"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022898"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-100"></a><span>                    </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-101"></a><span>                    </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-102"></a><span>                    </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022897"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022899"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- |  The 'has' function returns 'True' if the element appears in the list;</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- it is equivalent to 'member' except the order of the arguments is reversed,</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- making it a function from an ordered list to its characteristic function.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">has</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022885"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022885"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022885"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-108"></a><a name="has"><a href="Data.List.Ordered.html#has"><span class="hs-identifier">has</span></a></a><span> </span><a name="local-6989586621679022900"><a href="#local-6989586621679022900"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679022901"><a href="#local-6989586621679022901"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#memberBy"><span class="hs-identifier hs-var">memberBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679022901"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679022900"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- |  The 'hasBy' function is the non-overloaded version of 'has'.</span><span>
</span><a name="line-111"></a><span class="hs-identifier">hasBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022884"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022884"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022884"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022884"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-112"></a><a name="hasBy"><a href="Data.List.Ordered.html#hasBy"><span class="hs-identifier">hasBy</span></a></a><span> </span><a name="local-6989586621679022902"><a href="#local-6989586621679022902"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679022903"><a href="#local-6989586621679022903"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679022904"><a href="#local-6989586621679022904"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#memberBy"><span class="hs-identifier hs-var">memberBy</span></a><span> </span><a href="#local-6989586621679022902"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022904"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679022903"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- |  The 'insertBag' function inserts an element into a list.  If the element</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- is already there,  then another copy of the element is inserted.</span><span>
</span><a name="line-116"></a><span class="hs-identifier">insertBag</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022883"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679022883"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-117"></a><a name="insertBag"><a href="Data.List.Ordered.html#insertBag"><span class="hs-identifier">insertBag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#insertBagBy"><span class="hs-identifier hs-var">insertBagBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- |  The 'insertBagBy' function is the non-overloaded version of 'insertBag'.</span><span>
</span><a name="line-120"></a><span class="hs-identifier">insertBagBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-121"></a><a name="insertBagBy"><a href="Data.List.Ordered.html#insertBagBy"><span class="hs-identifier">insertBagBy</span></a></a><span> </span><a name="local-6989586621679022905"><a href="#local-6989586621679022905"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022906"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-122"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-123"></a><span>    </span><a name="local-6989586621679022906"><a href="#local-6989586621679022906"><span class="hs-identifier">loop</span></a></a><span> </span><a name="local-6989586621679022907"><a href="#local-6989586621679022907"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022907"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022908"><a href="#local-6989586621679022908"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679022909"><a href="#local-6989586621679022909"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022910"><a href="#local-6989586621679022910"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022905"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022909"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-126"></a><span>         </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022909"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022906"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022910"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-127"></a><span>         </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022908"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022909"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022910"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- |  The 'insertSet' function inserts an element into an ordered list.</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- If the element is already there,  then the element replaces the existing</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- element.</span><span>
</span><a name="line-132"></a><span class="hs-identifier">insertSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022881"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679022881"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022881"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022881"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-133"></a><a name="insertSet"><a href="Data.List.Ordered.html#insertSet"><span class="hs-identifier">insertSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#insertSetBy"><span class="hs-identifier hs-var">insertSetBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- |  The 'insertSetBy' function is the non-overloaded version of 'insertSet'.</span><span>
</span><a name="line-136"></a><span class="hs-identifier">insertSetBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022880"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022880"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022880"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-137"></a><a name="insertSetBy"><a href="Data.List.Ordered.html#insertSetBy"><span class="hs-identifier">insertSetBy</span></a></a><span> </span><a name="local-6989586621679022911"><a href="#local-6989586621679022911"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022912"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-6989586621679022912"><a href="#local-6989586621679022912"><span class="hs-identifier">loop</span></a></a><span> </span><a name="local-6989586621679022913"><a href="#local-6989586621679022913"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022913"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022914"><a href="#local-6989586621679022914"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679022915"><a href="#local-6989586621679022915"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022916"><a href="#local-6989586621679022916"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022911"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022914"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022915"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-141"></a><span>            </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022914"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022915"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022916"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-142"></a><span>            </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022914"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022916"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-143"></a><span>            </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022915"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022912"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022914"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022916"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">{-
-- This function is moderately interesting,  as it encompasses all the
-- &quot;Venn diagram&quot; functions on two sets. (though not merge;  which isn't
-- a set function)

-- However, it doesn't seem that useful,  considering that of the 8 possible
-- functions,  there are only 4 interesting variations:  isect, union, minus,
-- and xunion.  Due to interactions with GHC's optimizer,  coded separately,
-- these have a smaller combined object code size than the object code size
-- for genSectBy.  (Or,  turn off certain optimizations and lose speed.)

-- Each individual object code can be recovered from genSectBy via GHC's
-- inliner and constant propagation;  but this doesn't save much in terms
-- of source code size and reduces portability.

-- Note that the Static Argument Transformation is necessary for this to work
-- correctly;  inlining genSectBy allows for cmp and p to be inlined as well,
-- or at least eliminate some indirect jumps.  All of the *By functions in
-- this module follow this idiom for this reason.

genSectBy :: (a -&gt; a -&gt; Ordering)
          -&gt; (Bool -&gt; Bool -&gt; Bool)
          -&gt; [a] -&gt; [a] -&gt; [a]
genSectBy cmp p = loop
  where
    loop [] ys | p False True = ys
               | otherwise    = []
    loop xs [] | p True False = xs
               | otherwise    = []
    loop (x:xs) (y:ys)
      = case cmp x y of
          LT | p True False -&gt; x : loop xs (y:ys)
             | otherwise    -&gt;     loop xs (y:ys)
          EQ | p True True  -&gt; x : loop xs ys
             | otherwise    -&gt;     loop xs ys
          GT | p False True -&gt; y : loop (x:xs) ys
             | otherwise    -&gt;     loop (x:xs) ys

-- Here's another variation that was suggested to me.  It is more general
-- than genSectBy, as it can implement a merge; but it cannot implement
-- a left-biased merge

foldrMergeBy :: (a -&gt; b -&gt; Ordering)
             -&gt; (a -&gt; c -&gt; c) -&gt; (b -&gt; c -&gt; c) -&gt; (a -&gt; b -&gt; c -&gt; c) -&gt; c
             -&gt; [a] -&gt; [b] -&gt; c
foldrMergeBy cmp addA addB unify z = loop
  where
    loop xs [] = foldr addA z xs
    loop [] ys = foldr addB z ys
    loop (x:xs) (y:ys)
      = case cmp x y of
          LT -&gt; x `addA` loop  xs (y:ys)
          EQ -&gt; unify x y (loop xs ys)
          GT -&gt; y `addB` loop (x:xs) ys
-}</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- |  The 'isect' function computes the intersection of two ordered lists.</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- An element occurs in the output as many times as the minimum number of</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- occurrences in either input.  If either input is a set,  then the output</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- is a set.</span><span>
</span><a name="line-205"></a><span class="hs-comment">--</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- &gt; isect [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 3,4 ]</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- &gt; isect [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == [ 1, 2,2 ]</span><span>
</span><a name="line-208"></a><span class="hs-identifier">isect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022879"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-209"></a><a name="isect"><a href="Data.List.Ordered.html#isect"><span class="hs-identifier">isect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#isectBy"><span class="hs-identifier hs-var">isectBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- |  The 'isectBy' function is the non-overloaded version of 'isect'.</span><span>
</span><a name="line-212"></a><span class="hs-identifier">isectBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022877"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022878"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022877"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022878"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022877"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-213"></a><a name="isectBy"><a href="Data.List.Ordered.html#isectBy"><span class="hs-identifier">isectBy</span></a></a><span> </span><a name="local-6989586621679022917"><a href="#local-6989586621679022917"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022918"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-214"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-215"></a><span>     </span><a name="local-6989586621679022918"><a href="#local-6989586621679022918"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022919"><a href="#local-6989586621679022919"><span class="hs-identifier">_ys</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-216"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022920"><a href="#local-6989586621679022920"><span class="hs-identifier">_xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-217"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022921"><a href="#local-6989586621679022921"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022922"><a href="#local-6989586621679022922"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022923"><a href="#local-6989586621679022923"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022924"><a href="#local-6989586621679022924"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022917"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022921"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022923"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-219"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022918"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022922"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022923"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022924"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022921"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022918"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022922"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679022924"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-221"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022918"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022921"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022922"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022924"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- |  The 'union' function computes the union of two ordered lists.</span><span>
</span><a name="line-224"></a><span class="hs-comment">-- An element occurs in the output as many times as the maximum number</span><span>
</span><a name="line-225"></a><span class="hs-comment">-- of occurrences in either input.  The output is a set if and only if</span><span>
</span><a name="line-226"></a><span class="hs-comment">-- both inputs are sets.</span><span>
</span><a name="line-227"></a><span class="hs-comment">--</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- &gt; union [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 1,2, 3,4, 5,6 ]</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- &gt; union [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == [ 1,1,1, 2,2,2 ]</span><span>
</span><a name="line-230"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022876"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-231"></a><a name="union"><a href="Data.List.Ordered.html#union"><span class="hs-identifier">union</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- |  The 'unionBy' function is the non-overloaded version of 'union'.</span><span>
</span><a name="line-234"></a><span class="hs-identifier">unionBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022875"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022875"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-235"></a><a name="unionBy"><a href="Data.List.Ordered.html#unionBy"><span class="hs-identifier">unionBy</span></a></a><span> </span><a name="local-6989586621679022925"><a href="#local-6989586621679022925"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022926"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-236"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>     </span><a name="local-6989586621679022926"><a href="#local-6989586621679022926"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022927"><a href="#local-6989586621679022927"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022927"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-238"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022928"><a href="#local-6989586621679022928"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022928"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-239"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022929"><a href="#local-6989586621679022929"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022930"><a href="#local-6989586621679022930"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022931"><a href="#local-6989586621679022931"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022932"><a href="#local-6989586621679022932"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022925"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022929"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022931"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-241"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022929"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022926"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022930"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022931"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022932"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022929"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022926"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022930"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679022932"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-243"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022931"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022926"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022929"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022930"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022932"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- |  The 'minus' function computes the difference of two ordered lists.</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- An element occurs in the output as many times as it occurs in</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- the first input, minus the number of occurrences in the second input.</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- If the first input is a set,  then the output is a set.</span><span>
</span><a name="line-249"></a><span class="hs-comment">--</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- &gt; minus [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 1,2 ]</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- &gt; minus [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == [ 2 ]</span><span>
</span><a name="line-252"></a><span class="hs-identifier">minus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022874"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-253"></a><a name="minus"><a href="Data.List.Ordered.html#minus"><span class="hs-identifier">minus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#minusBy"><span class="hs-identifier hs-var">minusBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- |  The 'minusBy' function is the non-overloaded version of 'minus'.</span><span>
</span><a name="line-256"></a><span class="hs-identifier">minusBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022872"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022873"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022873"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-257"></a><a name="minusBy"><a href="Data.List.Ordered.html#minusBy"><span class="hs-identifier">minusBy</span></a></a><span> </span><a name="local-6989586621679022933"><a href="#local-6989586621679022933"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022934"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-258"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-259"></a><span>     </span><a name="local-6989586621679022934"><a href="#local-6989586621679022934"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022935"><a href="#local-6989586621679022935"><span class="hs-identifier">_ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-260"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022936"><a href="#local-6989586621679022936"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022936"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-261"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022937"><a href="#local-6989586621679022937"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022938"><a href="#local-6989586621679022938"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022939"><a href="#local-6989586621679022939"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022940"><a href="#local-6989586621679022940"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022933"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022937"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022939"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-263"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022937"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022934"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022938"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022939"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022940"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022934"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022938"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679022940"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-265"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022934"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022937"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022938"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022940"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-comment">-- |  The 'minus'' function computes the difference of two ordered lists.</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- The result consists of elements from the first list that do not appear</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- in the second list.  If the first input is a set, then the output is</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- a set.</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- &gt; minus' [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 1,2 ]</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- &gt; minus' [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == []</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- &gt; minus' [ 1,1, 2,2 ] [ 2 ]          == [ 1,1 ]</span><span>
</span><a name="line-275"></a><span class="hs-identifier">minus'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022871"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022871"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022871"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022871"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-276"></a><a name="minus%27"><a href="Data.List.Ordered.html#minus%27"><span class="hs-identifier">minus'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#minusBy%27"><span class="hs-identifier hs-var">minusBy'</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-comment">-- |  The 'minusBy'' function is the non-overloaded version of 'minus''.</span><span>
</span><a name="line-279"></a><span class="hs-identifier">minusBy'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022869"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022870"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022869"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022870"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022869"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-280"></a><a name="minusBy%27"><a href="Data.List.Ordered.html#minusBy%27"><span class="hs-identifier">minusBy'</span></a></a><span> </span><a name="local-6989586621679022941"><a href="#local-6989586621679022941"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022942"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-281"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-282"></a><span>     </span><a name="local-6989586621679022942"><a href="#local-6989586621679022942"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022943"><a href="#local-6989586621679022943"><span class="hs-identifier">_ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-283"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022944"><a href="#local-6989586621679022944"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022944"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-284"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022945"><a href="#local-6989586621679022945"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022946"><a href="#local-6989586621679022946"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022947"><a href="#local-6989586621679022947"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022948"><a href="#local-6989586621679022948"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022941"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022945"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022947"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-286"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022945"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022942"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022946"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022947"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022948"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022942"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022946"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022947"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022948"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022942"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022945"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022946"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022948"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- |  The 'xunion' function computes the exclusive union of two ordered lists.</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- An element occurs in the output as many times as the absolute difference</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- between the number of occurrences in the inputs.  If both inputs</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- are sets,  then the output is a set.</span><span>
</span><a name="line-294"></a><span class="hs-comment">--</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- &gt; xunion [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 1,2, 5,6 ]</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- &gt; xunion [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == [ 1,1, 2 ]</span><span>
</span><a name="line-297"></a><span class="hs-identifier">xunion</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022868"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><a name="xunion"><a href="Data.List.Ordered.html#xunion"><span class="hs-identifier">xunion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#xunionBy"><span class="hs-identifier hs-var">xunionBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">-- |  The 'xunionBy' function is the non-overloaded version of 'xunion'.</span><span>
</span><a name="line-301"></a><span class="hs-identifier">xunionBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022867"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022867"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-302"></a><a name="xunionBy"><a href="Data.List.Ordered.html#xunionBy"><span class="hs-identifier">xunionBy</span></a></a><span> </span><a name="local-6989586621679022949"><a href="#local-6989586621679022949"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022950"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-303"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-304"></a><span>     </span><a name="local-6989586621679022950"><a href="#local-6989586621679022950"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022951"><a href="#local-6989586621679022951"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022951"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-305"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022952"><a href="#local-6989586621679022952"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022952"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-306"></a><span>     </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022953"><a href="#local-6989586621679022953"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022954"><a href="#local-6989586621679022954"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022955"><a href="#local-6989586621679022955"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022956"><a href="#local-6989586621679022956"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022949"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022953"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022955"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-308"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022953"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022950"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022954"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022955"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022956"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span>     </span><a href="#local-6989586621679022950"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022954"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679022956"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-310"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022955"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022950"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022953"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022954"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022956"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">-- |  The 'merge' function combines all elements of two ordered lists.</span><span>
</span><a name="line-313"></a><span class="hs-comment">-- An element occurs in the output as many times as the sum of the</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- occurrences in both lists.   The output is a set if and only if</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- the inputs are disjoint sets.</span><span>
</span><a name="line-316"></a><span class="hs-comment">--</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- &gt; merge [ 1,2, 3,4 ] [ 3,4, 5,6 ]   == [ 1,2,  3,3,4,4,  5,6 ]</span><span>
</span><a name="line-318"></a><span class="hs-comment">-- &gt; merge [ 1, 2,2,2 ] [ 1,1,1, 2,2 ] == [ 1,1,1,1,  2,2,2,2,2 ]</span><span>
</span><a name="line-319"></a><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022866"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022866"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022866"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022866"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-320"></a><a name="merge"><a href="Data.List.Ordered.html#merge"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- |  The 'mergeBy' function is the non-overloaded version of 'merge'.</span><span>
</span><a name="line-323"></a><span class="hs-identifier">mergeBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022865"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022865"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-324"></a><a name="mergeBy"><a href="Data.List.Ordered.html#mergeBy"><span class="hs-identifier">mergeBy</span></a></a><span> </span><a name="local-6989586621679022957"><a href="#local-6989586621679022957"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022958"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-325"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-326"></a><span>    </span><a name="local-6989586621679022958"><a href="#local-6989586621679022958"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022959"><a href="#local-6989586621679022959"><span class="hs-identifier">ys</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022959"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-327"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022960"><a href="#local-6989586621679022960"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022960"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-328"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022961"><a href="#local-6989586621679022961"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022962"><a href="#local-6989586621679022962"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022963"><a href="#local-6989586621679022963"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022964"><a href="#local-6989586621679022964"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022957"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022961"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022963"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-330"></a><span>         </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022963"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022958"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022961"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022962"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022964"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-331"></a><span>         </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022961"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679022958"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022962"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022963"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022964"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">-- |  The 'subset' function returns true if the first list is a sub-list</span><span>
</span><a name="line-334"></a><span class="hs-comment">-- of the second.</span><span>
</span><a name="line-335"></a><span class="hs-identifier">subset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022864"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022864"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022864"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-336"></a><a name="subset"><a href="Data.List.Ordered.html#subset"><span class="hs-identifier">subset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#subsetBy"><span class="hs-identifier hs-var">subsetBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-comment">-- |  The 'subsetBy' function is the non-overloaded version of 'subset'.</span><span>
</span><a name="line-339"></a><span class="hs-identifier">subsetBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022863"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022863"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022863"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022863"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-340"></a><a name="subsetBy"><a href="Data.List.Ordered.html#subsetBy"><span class="hs-identifier">subsetBy</span></a></a><span> </span><a name="local-6989586621679022965"><a href="#local-6989586621679022965"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679022966"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-341"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-342"></a><span>    </span><a name="local-6989586621679022966"><a href="#local-6989586621679022966"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679022967"><a href="#local-6989586621679022967"><span class="hs-identifier">_ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-343"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679022968"><a href="#local-6989586621679022968"><span class="hs-identifier">_xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-344"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022969"><a href="#local-6989586621679022969"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022970"><a href="#local-6989586621679022970"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679022971"><a href="#local-6989586621679022971"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679022972"><a href="#local-6989586621679022972"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-345"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679022965"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679022969"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679022971"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-346"></a><span>         </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-347"></a><span>         </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022966"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679022970"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679022972"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-348"></a><span>         </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022966"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022969"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679022970"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679022972"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">{-
-- This is Ian Lynagh's mergesort implementation,  which appeared as
-- Data.List.sort, with the static argument transformation applied.
-- It's not clear whether this modification is truly worthwhile or not.

sort :: Ord a =&gt; [a] -&gt; [a]
sort = sortBy compare

sortBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
sortBy cmp = foldt (mergeBy cmp) [] . map (\x -&gt; [x])
-}</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,7,1)
</span><span class="hs-comment">-- |  The 'sortOn' function provides the decorate-sort-undecorate idiom,</span><span>
</span><a name="line-364"></a><span class="hs-comment">-- also known as the \&quot;Schwartzian transform\&quot;.</span><span>
</span><a name="line-365"></a><span class="hs-identifier">sortOn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ord</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-366"></a><span class="hs-identifier">sortOn</span><span> </span><span class="hs-identifier">f</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">sortOn'</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-operator">.</span><span>  </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- |  This variant of 'sortOn' recomputes the sorting key every comparison.</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- This can be better for functions that are cheap to compute.</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- This is definitely better for projections,  as the decorate-sort-undecorate</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- saves nothing and adds two traversals of the list and extra memory</span><span>
</span><a name="line-373"></a><span class="hs-comment">-- allocation.</span><span>
</span><a name="line-374"></a><span class="hs-identifier">sortOn'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022861"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022862"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022861"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022862"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022862"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-375"></a><a name="sortOn%27"><a href="Data.List.Ordered.html#sortOn%27"><span class="hs-identifier">sortOn'</span></a></a><span> </span><a name="local-6989586621679022973"><a href="#local-6989586621679022973"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sortBy</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023124"><a href="#local-6989586621679023124"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679023125"><a href="#local-6989586621679023125"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022973"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679023124"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022973"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679023125"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- |  The 'nubSort' function is equivalent to @'nub' '.' 'sort'@,  except</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- that duplicates are removed as it sorts. It is essentially the same</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- implementation as @Data.List.sort@, with 'merge' replaced by 'union'.</span><span>
</span><a name="line-380"></a><span class="hs-comment">-- Thus the performance of 'nubSort' should better than or nearly equal</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- to 'sort' alone.  It is faster than both 'sort' and @'nub' '.' 'sort'@</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- when the input contains significant quantities of duplicated elements.</span><span>
</span><a name="line-383"></a><span class="hs-identifier">nubSort</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022860"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-384"></a><a name="nubSort"><a href="Data.List.Ordered.html#nubSort"><span class="hs-identifier">nubSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#nubSortBy"><span class="hs-identifier hs-var">nubSortBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span class="hs-comment">-- |  The 'nubSortBy' function is the non-overloaded version of 'nubSort'.</span><span>
</span><a name="line-387"></a><span class="hs-identifier">nubSortBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022859"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022859"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022859"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022859"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-388"></a><a name="nubSortBy"><a href="Data.List.Ordered.html#nubSortBy"><span class="hs-identifier">nubSortBy</span></a></a><span> </span><a name="local-6989586621679023126"><a href="#local-6989586621679023126"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#foldt%27"><span class="hs-identifier hs-var">foldt'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span> </span><a href="#local-6989586621679023126"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679023127"><span class="hs-identifier hs-var">runs</span></a><span>
</span><a name="line-389"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-390"></a><span>    </span><span class="hs-comment">-- 'runs' partitions the input into sublists that are monotonic,</span><span>
</span><a name="line-391"></a><span>    </span><span class="hs-comment">-- contiguous,  and non-overlapping.   Descending runs are reversed</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-comment">-- and adjacent duplicates are eliminated,  so every run returned is</span><span>
</span><a name="line-393"></a><span>    </span><span class="hs-comment">-- strictly ascending.</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span>    </span><a name="local-6989586621679023127"><a href="#local-6989586621679023127"><span class="hs-identifier">runs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023130"><a href="#local-6989586621679023130"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023131"><a href="#local-6989586621679023131"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023132"><a href="#local-6989586621679023132"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023126"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023130"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679023131"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-397"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023129"><span class="hs-identifier hs-var">asc</span></a><span> </span><a href="#local-6989586621679023131"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023130"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023132"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-398"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023127"><span class="hs-identifier hs-var">runs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023130"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023132"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023128"><span class="hs-identifier hs-var">desc</span></a><span> </span><a href="#local-6989586621679023131"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023130"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679023132"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-400"></a><span>    </span><span class="hs-identifier">runs</span><span> </span><a name="local-6989586621679023133"><a href="#local-6989586621679023133"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023133"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span>    </span><a name="local-6989586621679023128"><a href="#local-6989586621679023128"><span class="hs-identifier">desc</span></a></a><span> </span><a name="local-6989586621679023134"><a href="#local-6989586621679023134"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023134"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">]</span><span>
</span><a name="line-403"></a><span>    </span><span class="hs-identifier">desc</span><span> </span><a name="local-6989586621679023136"><a href="#local-6989586621679023136"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679023138"><a href="#local-6989586621679023138"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023139"><a href="#local-6989586621679023139"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023126"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023136"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679023138"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-405"></a><span>          </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023136"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023127"><span class="hs-identifier hs-var">runs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023138"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023139"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span>          </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023128"><span class="hs-identifier hs-var">desc</span></a><span> </span><a href="#local-6989586621679023136"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679023139"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-407"></a><span>          </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023128"><span class="hs-identifier hs-var">desc</span></a><span> </span><a href="#local-6989586621679023138"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023136"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023139"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span>    </span><a name="local-6989586621679023129"><a href="#local-6989586621679023129"><span class="hs-identifier">asc</span></a></a><span> </span><a name="local-6989586621679023140"><a href="#local-6989586621679023140"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023140"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-identifier">asc</span><span> </span><a name="local-6989586621679023142"><a href="#local-6989586621679023142"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679023144"><a href="#local-6989586621679023144"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023145"><a href="#local-6989586621679023145"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023126"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023142"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679023144"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-412"></a><span>         </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023129"><span class="hs-identifier hs-var">asc</span></a><span> </span><a href="#local-6989586621679023144"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023146"><a href="#local-6989586621679023146"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023142"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023146"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023145"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-413"></a><span>         </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023129"><span class="hs-identifier hs-var">asc</span></a><span> </span><a href="#local-6989586621679023142"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679023145"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-414"></a><span>         </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023142"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023127"><span class="hs-identifier hs-var">runs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023144"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023145"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">-- |  The 'nubSortOn' function provides decorate-sort-undecorate for 'nubSort'.</span><span>
</span><a name="line-417"></a><span class="hs-identifier">nubSortOn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022857"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022858"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022857"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022858"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022858"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-418"></a><a name="nubSortOn"><a href="Data.List.Ordered.html#nubSortOn"><span class="hs-identifier">nubSortOn</span></a></a><span> </span><a name="local-6989586621679023147"><a href="#local-6989586621679023147"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Ordered.html#nubSortOn%27"><span class="hs-identifier hs-var">nubSortOn'</span></a><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023163"><a href="#local-6989586621679023163"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679023164"><a href="#local-6989586621679023164"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023147"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679023163"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679023164"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023164"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679023163"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- |  This variant of 'nubSortOn' recomputes the sorting key for each comparison</span><span>
</span><a name="line-421"></a><span class="hs-identifier">nubSortOn'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022855"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022856"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022855"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022856"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022856"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-422"></a><a name="nubSortOn%27"><a href="Data.List.Ordered.html#nubSortOn%27"><span class="hs-identifier">nubSortOn'</span></a></a><span> </span><a name="local-6989586621679023165"><a href="#local-6989586621679023165"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#nubSortBy"><span class="hs-identifier hs-var">nubSortBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023166"><a href="#local-6989586621679023166"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679023167"><a href="#local-6989586621679023167"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023165"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679023166"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023165"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679023167"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">-- | On ordered lists,  'nub' is equivalent to 'Data.List.nub', except that</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- it runs in linear time instead of quadratic.   On unordered lists it also</span><span>
</span><a name="line-426"></a><span class="hs-comment">-- removes elements that are smaller than any preceding element.</span><span>
</span><a name="line-427"></a><span class="hs-comment">--</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- &gt; nub [1,1,1,2,2] == [1,2]</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- &gt; nub [2,0,1,3,3] == [2,3]</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- &gt; nub = nubBy (&lt;)</span><span>
</span><a name="line-431"></a><span class="hs-identifier">nub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022854"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-432"></a><a name="nub"><a href="Data.List.Ordered.html#nub"><span class="hs-identifier">nub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-comment">-- | The 'nubBy' function is the greedy algorithm that returns a</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- sublist of its input such that:</span><span>
</span><a name="line-436"></a><span class="hs-comment">--</span><span>
</span><a name="line-437"></a><span class="hs-comment">-- &gt; isSortedBy pred (nubBy pred xs) == True</span><span>
</span><a name="line-438"></a><span class="hs-comment">--</span><span>
</span><a name="line-439"></a><span class="hs-comment">-- This is true for all lists,  not just ordered lists,  and all binary</span><span>
</span><a name="line-440"></a><span class="hs-comment">-- predicates,  not just total orders.   On infinite lists,  this statement</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- is true in a certain mathematical sense,  but not a computational one.</span><span>
</span><a name="line-442"></a><span class="hs-identifier">nubBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022853"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022853"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-443"></a><a name="nubBy"><a href="Data.List.Ordered.html#nubBy"><span class="hs-identifier">nubBy</span></a></a><span> </span><a name="local-6989586621679023168"><a href="#local-6989586621679023168"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-444"></a><span class="hs-identifier">nubBy</span><span> </span><a name="local-6989586621679023169"><a href="#local-6989586621679023169"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023170"><a href="#local-6989586621679023170"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023171"><a href="#local-6989586621679023171"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023170"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023172"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679023170"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023171"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-445"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-446"></a><span>    </span><a name="local-6989586621679023172"><a href="#local-6989586621679023172"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-447"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679023173"><a href="#local-6989586621679023173"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023174"><a href="#local-6989586621679023174"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023175"><a href="#local-6989586621679023175"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023169"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679023173"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023174"><span class="hs-identifier hs-var">y</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023174"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023172"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679023174"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679023175"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-449"></a><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023172"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679023173"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023175"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-comment">-- | The function @'foldt'' plus zero@ computes the sum of a list</span><span>
</span><a name="line-452"></a><span class="hs-comment">-- using a balanced tree of operations.  'foldt'' necessarily diverges</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- on infinite lists, hence it is a stricter variant of 'foldt'.</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- 'foldt'' is used in the implementation of 'sort' and 'nubSort'.</span><span>
</span><a name="line-455"></a><span class="hs-identifier">foldt'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022852"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-456"></a><a name="foldt%27"><a href="Data.List.Ordered.html#foldt%27"><span class="hs-identifier">foldt'</span></a></a><span> </span><a name="local-6989586621679023176"><a href="#local-6989586621679023176"><span class="hs-identifier">plus</span></a></a><span> </span><a name="local-6989586621679023177"><a href="#local-6989586621679023177"><span class="hs-identifier">zero</span></a></a><span> </span><a name="local-6989586621679023178"><a href="#local-6989586621679023178"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-457"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023178"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-458"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023177"><span class="hs-identifier hs-var">zero</span></a><span>
</span><a name="line-459"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023179"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679023178"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-460"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-461"></a><span>    </span><a name="local-6989586621679023179"><a href="#local-6989586621679023179"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679023181"><a href="#local-6989586621679023181"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023181"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-462"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><a name="local-6989586621679023182"><a href="#local-6989586621679023182"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023179"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023180"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679023182"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span>    </span><a name="local-6989586621679023180"><a href="#local-6989586621679023180"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023183"><a href="#local-6989586621679023183"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023184"><a href="#local-6989586621679023184"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023185"><a href="#local-6989586621679023185"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023176"><span class="hs-identifier hs-var">plus</span></a><span> </span><a href="#local-6989586621679023183"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023184"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023180"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679023185"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-465"></a><span>    </span><span class="hs-identifier">pairs</span><span> </span><a name="local-6989586621679023186"><a href="#local-6989586621679023186"><span class="hs-identifier">zs</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023186"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-comment">-- | The function @'foldt' plus zero@ computes the sum of a list using</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- a sequence of balanced trees of operations.   Given an appropriate @plus@</span><span>
</span><a name="line-469"></a><span class="hs-comment">-- operator,  this function can be productive on an infinite list, hence it</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- is lazier than 'foldt''.   'foldt' is used in the implementation of</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- 'mergeAll' and 'unionAll'.</span><span>
</span><a name="line-472"></a><span class="hs-identifier">foldt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022851"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-473"></a><a name="foldt"><a href="Data.List.Ordered.html#foldt"><span class="hs-identifier">foldt</span></a></a><span> </span><a name="local-6989586621679023187"><a href="#local-6989586621679023187"><span class="hs-identifier">plus</span></a></a><span> </span><a name="local-6989586621679023188"><a href="#local-6989586621679023188"><span class="hs-identifier">zero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023189"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-474"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-475"></a><span>    </span><a name="local-6989586621679023189"><a href="#local-6989586621679023189"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023188"><span class="hs-identifier hs-var">zero</span></a><span>
</span><a name="line-476"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679023191"><a href="#local-6989586621679023191"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023192"><a href="#local-6989586621679023192"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023191"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679023187"><span class="hs-identifier hs-var">plus</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679023189"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023190"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679023192"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span>    </span><a name="local-6989586621679023190"><a href="#local-6989586621679023190"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023193"><a href="#local-6989586621679023193"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023194"><a href="#local-6989586621679023194"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023195"><a href="#local-6989586621679023195"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023187"><span class="hs-identifier hs-var">plus</span></a><span> </span><a href="#local-6989586621679023193"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023194"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679023190"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679023195"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-479"></a><span>    </span><span class="hs-identifier">pairs</span><span> </span><a name="local-6989586621679023196"><a href="#local-6989586621679023196"><span class="hs-identifier">zs</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023196"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-comment">-- helper functions used in 'mergeAll' and 'unionAll'</span><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-keyword">data</span><span> </span><a name="People"><a href="Data.List.Ordered.html#People"><span class="hs-identifier">People</span></a></a><span> </span><a name="local-6989586621679017117"><a href="#local-6989586621679017117"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="VIP"><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier">VIP</span></a></a><span> </span><a href="#local-6989586621679017117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#People"><span class="hs-identifier hs-type">People</span></a><span> </span><a href="#local-6989586621679017117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Crowd"><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier">Crowd</span></a></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679017117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><a name="serve"><a href="Data.List.Ordered.html#serve"><span class="hs-identifier">serve</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023197"><a href="#local-6989586621679023197"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679023198"><a href="#local-6989586621679023198"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023197"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="Data.List.Ordered.html#serve"><span class="hs-identifier hs-var">serve</span></a><span> </span><a href="#local-6989586621679023198"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-486"></a><span class="hs-identifier">serve</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a name="local-6989586621679023199"><a href="#local-6989586621679023199"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023199"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><a name="vips"><a href="Data.List.Ordered.html#vips"><span class="hs-identifier">vips</span></a></a><span> </span><a name="local-6989586621679023200"><a href="#local-6989586621679023200"><span class="hs-identifier">xss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023201"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a href="#local-6989586621679023202"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679023201"><a href="#local-6989586621679023201"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023202"><a href="#local-6989586621679023202"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679023200"><span class="hs-identifier hs-var">xss</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-comment">-- | The 'mergeAll' function merges a (potentially) infinite number of</span><span>
</span><a name="line-491"></a><span class="hs-comment">-- ordered lists, under the assumption that the heads of the inner lists</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- are sorted.  An element is duplicated in the result as many times as</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- the total number of occurrences in all inner lists.</span><span>
</span><a name="line-494"></a><span class="hs-comment">--</span><span>
</span><a name="line-495"></a><span class="hs-comment">-- The 'mergeAll' function is closely related to @'foldr' 'merge' []@.</span><span>
</span><a name="line-496"></a><span class="hs-comment">-- The former does not assume that the outer list is finite, whereas</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- the latter does not assume that the heads of the inner lists are sorted.</span><span>
</span><a name="line-498"></a><span class="hs-comment">-- When both sets of assumptions are met,  these two functions are</span><span>
</span><a name="line-499"></a><span class="hs-comment">-- equivalent.</span><span>
</span><a name="line-500"></a><span class="hs-comment">--</span><span>
</span><a name="line-501"></a><span class="hs-comment">-- This implementation of 'mergeAll'  uses a tree of comparisons, and is</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- based on input from Dave Bayer, Heinrich Apfelmus, Omar Antolin Camarena,</span><span>
</span><a name="line-503"></a><span class="hs-comment">-- and Will Ness.  See @CHANGES@ for details.</span><span>
</span><a name="line-504"></a><span class="hs-identifier">mergeAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679022850"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679022850"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022850"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-505"></a><a name="mergeAll"><a href="Data.List.Ordered.html#mergeAll"><span class="hs-identifier">mergeAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#mergeAllBy"><span class="hs-identifier hs-var">mergeAllBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-comment">-- | The 'mergeAllBy' function is the non-overloaded variant of the 'mergeAll'</span><span>
</span><a name="line-508"></a><span class="hs-comment">-- function.</span><span>
</span><a name="line-509"></a><span class="hs-identifier">mergeAllBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679022849"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679022849"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679022849"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679022849"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-510"></a><a name="mergeAllBy"><a href="Data.List.Ordered.html#mergeAllBy"><span class="hs-identifier">mergeAllBy</span></a></a><span> </span><a name="local-6989586621679023203"><a href="#local-6989586621679023203"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#serve"><span class="hs-identifier hs-var">serve</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Ordered.html#foldt"><span class="hs-identifier hs-var">foldt</span></a><span> </span><a href="#local-6989586621679023204"><span class="hs-identifier hs-var">merge'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Ordered.html#vips"><span class="hs-identifier hs-var">vips</span></a><span>
</span><a name="line-511"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-512"></a><span>    </span><a name="local-6989586621679023204"><a href="#local-6989586621679023204"><span class="hs-identifier">merge'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023205"><a href="#local-6989586621679023205"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679023206"><a href="#local-6989586621679023206"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679023207"><a href="#local-6989586621679023207"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023205"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023204"><span class="hs-identifier hs-var">merge'</span></a><span> </span><a href="#local-6989586621679023206"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023207"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>    </span><span class="hs-identifier">merge'</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679023208"><a href="#local-6989586621679023208"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023208"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier">merge'</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a name="local-6989586621679023209"><a href="#local-6989586621679023209"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a name="local-6989586621679023210"><a href="#local-6989586621679023210"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span> </span><a href="#local-6989586621679023203"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023209"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023210"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-515"></a><span>    </span><span class="hs-identifier">merge'</span><span> </span><a name="local-6989586621679023211"><a href="#local-6989586621679023211"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023212"><a href="#local-6989586621679023212"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023213"><a href="#local-6989586621679023213"><span class="hs-identifier">xt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679023214"><a href="#local-6989586621679023214"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023215"><a href="#local-6989586621679023215"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679023216"><a href="#local-6989586621679023216"><span class="hs-identifier">yt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023203"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023212"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023215"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-517"></a><span>         </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023215"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023204"><span class="hs-identifier hs-var">merge'</span></a><span> </span><a href="#local-6989586621679023211"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023216"><span class="hs-identifier hs-var">yt</span></a><span class="hs-special">)</span><span>
</span><a name="line-518"></a><span>         </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023212"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023204"><span class="hs-identifier hs-var">merge'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a href="#local-6989586621679023213"><span class="hs-identifier hs-var">xt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023214"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-comment">-- | The 'unionAll' computes the union of a (potentially) infinite number</span><span>
</span><a name="line-521"></a><span class="hs-comment">-- of lists,  under the assumption that the heads of the inner lists</span><span>
</span><a name="line-522"></a><span class="hs-comment">-- are sorted.  The result will duplicate an element as many times as</span><span>
</span><a name="line-523"></a><span class="hs-comment">-- the maximum number of occurrences in any single list.  Thus, the result</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- is a set if and only if every inner list is a set.</span><span>
</span><a name="line-525"></a><span class="hs-comment">--</span><span>
</span><a name="line-526"></a><span class="hs-comment">-- The 'unionAll' function is closely related to @'foldr' 'union' []@.</span><span>
</span><a name="line-527"></a><span class="hs-comment">-- The former does not assume that the outer list is finite, whereas</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- the latter does not assume that the heads of the inner lists are sorted.</span><span>
</span><a name="line-529"></a><span class="hs-comment">-- When both sets of assumptions are met,  these two functions are</span><span>
</span><a name="line-530"></a><span class="hs-comment">-- equivalent.</span><span>
</span><a name="line-531"></a><span class="hs-comment">--</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- Note that there is no simple way to express 'unionAll' in terms of</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- 'mergeAll' or vice versa on arbitrary valid inputs.  They are related</span><span>
</span><a name="line-534"></a><span class="hs-comment">-- via 'nub' however,  as @'nub' . 'mergeAll' == 'unionAll' . 'map' 'nub'@.</span><span>
</span><a name="line-535"></a><span class="hs-comment">-- If every list is a set,  then @map nub == id@,  and in this special case</span><span>
</span><a name="line-536"></a><span class="hs-comment">-- (and only in this special case) does @nub . mergeAll == unionAll@.</span><span>
</span><a name="line-537"></a><span class="hs-comment">--</span><span>
</span><a name="line-538"></a><span class="hs-comment">-- This implementation of 'unionAll'  uses a tree of comparisons, and is</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- based on input from Dave Bayer, Heinrich Apfelmus, Omar Antolin Camarena,</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- and Will Ness.  See @CHANGES@ for details.</span><span>
</span><a name="line-541"></a><span class="hs-identifier">unionAll</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679018960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679018960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679018960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-542"></a><a name="unionAll"><a href="Data.List.Ordered.html#unionAll"><span class="hs-identifier">unionAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#unionAllBy"><span class="hs-identifier hs-var">unionAllBy</span></a><span> </span><span class="hs-identifier hs-var">compare</span><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- | The 'unionAllBy' function is the non-overloaded variant of the 'unionAll'</span><span>
</span><a name="line-545"></a><span class="hs-comment">-- function.</span><span>
</span><a name="line-546"></a><span class="hs-identifier">unionAllBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679017118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679017118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-547"></a><a name="unionAllBy"><a href="Data.List.Ordered.html#unionAllBy"><span class="hs-identifier">unionAllBy</span></a></a><span> </span><a name="local-6989586621679023217"><a href="#local-6989586621679023217"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#serve"><span class="hs-identifier hs-var">serve</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Ordered.html#foldt"><span class="hs-identifier hs-var">foldt</span></a><span> </span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Ordered.html#vips"><span class="hs-identifier hs-var">vips</span></a><span>
</span><a name="line-548"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-549"></a><span>    </span><a name="local-6989586621679023218"><a href="#local-6989586621679023218"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data.List.Ordered.unionAllBy:  the heads of the lists are not sorted&quot;</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span>    </span><a name="local-6989586621679023219"><a href="#local-6989586621679023219"><span class="hs-identifier">union'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023220"><a href="#local-6989586621679023220"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679023221"><a href="#local-6989586621679023221"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679023222"><a href="#local-6989586621679023222"><span class="hs-identifier">ys</span></a></a><span>
</span><a name="line-552"></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023220"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023222"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-553"></a><span>                  </span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><a href="#local-6989586621679023221"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023222"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-554"></a><span>                  </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023223"><a href="#local-6989586621679023223"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679023224"><a href="#local-6989586621679023224"><span class="hs-identifier">yt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023217"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023220"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023223"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-555"></a><span>                               </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><a href="#local-6989586621679023221"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023222"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-556"></a><span>                               </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><a href="#local-6989586621679023221"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023224"><span class="hs-identifier hs-var">yt</span></a><span>
</span><a name="line-557"></a><span>                               </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><a href="#local-6989586621679023218"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-558"></a><span>    </span><span class="hs-identifier">union'</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679023239"><a href="#local-6989586621679023239"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023239"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-559"></a><span>    </span><span class="hs-identifier">union'</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a name="local-6989586621679023240"><a href="#local-6989586621679023240"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a name="local-6989586621679023241"><a href="#local-6989586621679023241"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span> </span><a href="#local-6989586621679023217"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023240"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023241"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>    </span><span class="hs-identifier">union'</span><span> </span><a name="local-6989586621679023242"><a href="#local-6989586621679023242"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023243"><a href="#local-6989586621679023243"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023244"><a href="#local-6989586621679023244"><span class="hs-identifier">xt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679023245"><a href="#local-6989586621679023245"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a name="local-6989586621679023246"><a href="#local-6989586621679023246"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679023247"><a href="#local-6989586621679023247"><span class="hs-identifier">yt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679023217"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679023243"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679023246"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-562"></a><span>           </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023243"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a href="#local-6989586621679023244"><span class="hs-identifier hs-var">xt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023245"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>           </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023243"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Ordered.html#Crowd"><span class="hs-identifier hs-var">Crowd</span></a><span> </span><a href="#local-6989586621679023244"><span class="hs-identifier hs-var">xt</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023247"><span class="hs-identifier hs-var">yt</span></a><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span>           </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Ordered.html#VIP"><span class="hs-identifier hs-var">VIP</span></a><span> </span><a href="#local-6989586621679023246"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023219"><span class="hs-identifier hs-var">union'</span></a><span> </span><a href="#local-6989586621679023242"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023247"><span class="hs-identifier hs-var">yt</span></a><span class="hs-special">)</span><span>
</span><a name="line-565"></a></pre></body></html>